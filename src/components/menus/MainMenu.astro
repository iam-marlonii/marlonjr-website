---
import { iconMap } from '../../config/icons';
import Terminal from '../terminal/Terminal.astro';
import MarlonAusbyJuniorBlueIcon from '../../assets/logos/MarlonAusbyJunior-Icon-Blue.png?url';

interface Props {
	currentPath?: string;
}
const currentPath = Astro.props.currentPath ?? Astro.url.pathname ?? '/';
const normalizedPath = currentPath.replace(/\/$/, '') || '/';
const navLinkClass = 'relative flex items-center gap-2 z-10 px-2 py-1 rounded-full text-sm bg-transparent font-regular hover:bg-(--color-skyBlue)/30 transition-colors duration-200';
const homeLinkClass = 'relative flex items-center gap-1 z-10 p-1 text-sm bg-transparent rounded-full font-regular hover:bg-(--color-skyBlue)/30 transition-colors duration-200';
const isActive = (path: string) => normalizedPath === (path.replace(/\/$/, '') || '/');
---

<header class="menu absolute top-0 left-0 right-0 z-200 flex items-center justify-center h-[80px] backdrop-blur-md min-[1031px]:flex font-kode-mono">
    <div class="flex items-center justify-between w-full max-w-[1280px] px-6">
        <!-- Logo -->
        <div class="flex items-center">
            <a href="https://earth.google.com/web/search/Florida/@27.59465368,-83.80452183,-40.829389a,2109986.78634954d,35y,0h,0t,0r/data=CnYaSBJCCiUweDg4YzE3NjY1OTE1NjJhYmY6MHhmNzJlMTNkMzViYzc0ZWQwGRZ85CAyqjtAIQvT9xoCYVTAKgdGbG9yaWRhGAIgASImCiQJIXRub1JMN0ARHnRub1JMN8AZFb9vu5g7SkAh4wB57gW7SsBCAggBOgMKATBCAggASg0I____________ARAA" target="_blank" rel="noopener noreferrer" class="shrink-0 text-sm border-b-2 border-b-transparent hover:border-(--color-skyBlue)/40 transition-colors duration-200">
                Florida/USA
            </a>
        </div>

        <!-- Navigation Links -->
        <nav class="nav-container relative flex items-center gap-2 p-1 border-2 border-(--color-skyBlue)/40 rounded-full">
            <a 
                href="/" 
                class:list={[homeLinkClass, isActive('/') && 'nav-link-active']}
                aria-current={isActive('/') ? 'page' : undefined}
            >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-5 h-5" fill="currentColor">
                <path d="M304 70.1C313.1 61.9 326.9 61.9 336 70.1L568 278.1C577.9 286.9 578.7 302.1 569.8 312C560.9 321.9 545.8 322.7 535.9 313.8L527.9 306.6L527.9 511.9C527.9 547.2 499.2 575.9 463.9 575.9L175.9 575.9C140.6 575.9 111.9 547.2 111.9 511.9L111.9 306.6L103.9 313.8C94 322.6 78.9 321.8 70 312C61.1 302.2 62 287 71.8 278.1L304 70.1zM320 120.2L160 263.7L160 512C160 520.8 167.2 528 176 528L224 528L224 424C224 384.2 256.2 352 296 352L344 352C383.8 352 416 384.2 416 424L416 528L464 528C472.8 528 480 520.8 480 512L480 263.7L320 120.3zM272 528L368 528L368 424C368 410.7 357.3 400 344 400L296 400C282.7 400 272 410.7 272 424L272 528z"/>
            </svg>
        </a>
        <div class="bg-(--color-skyBlue)/40 w-[0.5px] h-5 rounded-full">
        </div>
            <a 
                href="/about" 
                class:list={[navLinkClass, isActive('/about') && 'nav-link-active']}
                aria-current={isActive('/about') ? 'page' : undefined}
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-4 h-4" fill="currentColor">
                    <path d="M448 224C448 153.3 390.7 96 320 96C249.3 96 192 153.3 192 224C192 294.7 249.3 352 320 352C390.7 352 448 294.7 448 224zM320 48C394.6 48 458.4 94.4 484 160L488 160C501.3 160 512 170.7 512 184L512 264C512 277.3 501.3 288 488 288L484 288C458.4 353.6 394.6 400 320 400C245.4 400 181.6 353.6 156 288L152 288C138.7 288 128 277.3 128 264L128 184C128 170.7 138.7 160 152 160L156 160C181.6 94.4 245.4 48 320 48zM224 240C224 195.8 259.8 160 304 160L336 160C380.2 160 416 195.8 416 240C416 284.2 380.2 320 336 320L304 320C259.8 320 224 284.2 224 240zM309.3 226.7L303.3 205.5C302.4 202.2 299.4 200 296 200C292.6 200 289.6 202.2 288.7 205.5L282.7 226.7L261.5 232.7C258.2 233.6 256 236.6 256 240C256 243.4 258.2 246.4 261.5 247.3L282.7 253.3L288.7 274.5C289.6 277.8 292.6 280 296 280C299.4 280 302.4 277.8 303.3 274.5L309.3 253.3L330.5 247.3C333.8 246.4 336 243.4 336 240C336 236.6 333.8 233.6 330.5 232.7L309.3 226.7zM185.7 403.3C202.7 416.1 221.6 426.5 241.9 434C186.2 444.4 144 493.2 144 552C144 565.3 133.3 576 120 576C106.7 576 96 565.3 96 552C96 487.5 132.4 431.5 185.7 403.3zM398.1 434C418.4 426.5 437.3 416.1 454.3 403.3C507.7 431.4 544 487.5 544 552C544 565.3 533.3 576 520 576C506.7 576 496 565.3 496 552C496 493.3 453.8 444.4 398.1 434zM224 496L416 496C433.7 496 448 510.3 448 528L448 576L392 576L392 552C392 538.7 381.3 528 368 528C354.7 528 344 538.7 344 552L344 576L296 576L296 552C296 538.7 285.3 528 272 528C258.7 528 248 538.7 248 552L248 576L192 576L192 528C192 510.3 206.3 496 224 496z"/>
                </svg>
                About
            </a>
            <a 
                href="/resume" 
                class:list={[navLinkClass, isActive('/resume') && 'nav-link-active']}
                aria-current={isActive('/resume') ? 'page' : undefined}
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-4 h-4" fill="currentColor">
                    <path d="M192 112L304 112L304 200C304 239.8 336.2 272 376 272L464 272L464 512C464 520.8 456.8 528 448 528L192 528C183.2 528 176 520.8 176 512L176 128C176 119.2 183.2 112 192 112zM352 131.9L444.1 224L376 224C362.7 224 352 213.3 352 200L352 131.9zM192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 250.5C512 233.5 505.3 217.2 493.3 205.2L370.7 82.7C358.7 70.7 342.5 64 325.5 64L192 64zM320 400C346.5 400 368 378.5 368 352C368 325.5 346.5 304 320 304C293.5 304 272 325.5 272 352C272 378.5 293.5 400 320 400zM242.5 452.6C231.4 464.2 242.6 480 258.6 480L381.3 480C397.3 480 408.5 464.1 397.4 452.6C385.3 439.9 368.2 432 349.2 432L290.5 432C271.6 432 254.5 439.9 242.3 452.6z"/>
                </svg>
                Resume
            </a>
            <a 
                href="/projects" 
                class:list={[navLinkClass, isActive('/projects') && 'nav-link-active']}
                aria-current={isActive('/projects') ? 'page' : undefined}
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-4 h-4" fill="currentColor">
                    <path d="M136 88C136 57.1 161.1 32 192 32C222.9 32 248 57.1 248 88C248 118.9 222.9 144 192 144C161.1 144 136 118.9 136 88zM112 584L112 279.3L59.3 350.3C51.4 360.9 36.4 363.2 25.7 355.3C15 347.4 12.8 332.4 20.7 321.7L88.1 231C113.8 196.4 154.3 176 197.3 176L320 176L320 112C320 85.5 341.5 64 368 64L592 64C618.5 64 640 85.5 640 112L640 336C640 362.5 618.5 384 592 384L368 384C341.5 384 320 362.5 320 336L320 272L368 272L368 336L592 336L592 112L368 112L368 176L400 176C413.3 176 424 186.7 424 200C424 213.3 413.3 224 400 224L272 224L272 584C272 597.3 261.3 608 248 608C234.7 608 224 597.3 224 584L224 432L160 432L160 584C160 597.3 149.3 608 136 608C122.7 608 112 597.3 112 584zM160 384L224 384L224 224L197.3 224C184.2 224 171.5 226.9 160 232.3L160 384z"/>
                </svg>
                Projects
            </a>
            <a 
                href="/contact" 
                class:list={[navLinkClass, isActive('/contact') && 'nav-link-active']}
                aria-current={isActive('/contact') ? 'page' : undefined}
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-4 h-4" fill="currentColor">
                    <path d="M322.5 351.7L523.4 150.9L391 520.3L322.5 351.7zM489.4 117L288.6 317.8L120 249.3L489.4 117zM70.1 280.8L275.9 364.4L359.5 570.2C364.8 583.3 377.6 591.9 391.8 591.9C406.5 591.9 419.6 582.7 424.6 568.8L602.6 72C606.1 62.2 603.6 51.4 596.3 44C589 36.6 578.1 34.2 568.3 37.7L71.4 215.7C57.5 220.7 48.3 233.8 48.3 248.5C48.3 262.7 56.9 275.5 70 280.8z"/>
                </svg>
                Contact
            </a>
        </nav>

        <!-- Buttons -->
        <div class="relative flex gap-2">

            <button 
            id="terminal-toggle" 
            class="relative flex items-center z-10 p-2 rounded-full cursor-pointer text-sm bg-black border-2 border-(--color-skyBlue)/40 hover:border-(--color-skyBlue) transition-colors duration-200"
        >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" class="w-4 h-4" fill="currentColor">
                <path d="M71 169C61.7 159.6 61.7 144.4 71 135C80.3 125.6 95.6 125.7 105 135L273 303C282.4 312.4 282.4 327.6 273 336.9L105 505C95.6 514.4 80.4 514.4 71.1 505C61.8 495.6 61.7 480.4 71 471L222.1 320L71 169zM552 464C565.3 464 576 474.7 576 488C576 501.3 565.3 512 552 512L280 512C266.7 512 256 501.3 256 488C256 474.7 266.7 464 280 464L552 464z"/>
            </svg>
        </button>

            <a 
                href="/cheesecake"
                class:list={[
                    'relative flex items-center z-10 px-4 py-1 rounded-full cursor-pointer text-sm text-(--color-limeCream) bg-black border-2 border-(--color-limeCream)/30 hover:border-(--color-limeCream) transition-colors duration-200',
                    isActive('/cheesecake') ? 'nav-link-active-cheesecake' : 'bg-(--color-limeCream)/40'
                ]}
                aria-current={isActive('/cheesecake') ? 'page' : undefined}
            >
                Cheesecake
            </a>
        </div>
    </div>
    
    <!-- Terminal Dropdown -->
    <div 
        id="terminal-dropdown"
        class="hidden absolute left-0 right-0 top-[64px] z-50"
    >
        <div class="flex items-center justify-center w-full max-w-[1280px] mx-auto px-6">
            <Terminal client:load />
        </div>
    </div>
</header>

<style is:global>
	.nav-link-active {
		background-color: color-mix(in srgb, var(--color-skyBlue) 40%, transparent);
	}
	.nav-link-active-cheesecake {
		background-color: color-mix(in srgb, var(--color-limeCream) 60%, transparent);
	}
</style>

<script>
    function initTerminalToggle() {
        const toggleButton = document.getElementById('terminal-toggle');
        const dropdown = document.getElementById('terminal-dropdown');
        
        if (toggleButton && dropdown) {
            toggleButton.addEventListener('click', (e) => {
                e.stopPropagation();
                dropdown.classList.toggle('hidden');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                const target = e.target as Node;
                if (target && !dropdown.contains(target) && !toggleButton.contains(target)) {
                    dropdown.classList.add('hidden');
                }
            });
        }
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTerminalToggle);
    } else {
        initTerminalToggle();
    }
</script>

<!-- <style>
    .menu,
    .menu * {
        font-family: 'Kode Mono', monospace;
    }
</style>
-->
